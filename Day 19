Topics: ROW_NUMBER(), RANK(), DENSE_RANK(), OVER clause

### Practice Questions:

1. Rank patients by satisfaction score within each service.
2. Assign row numbers to staff ordered by their name.
3. Rank services by total patients admitted.

  ### Daily Challenge:

**Question:** For each service, rank the weeks by patient satisfaction score (highest first). Show service, week, patient_satisfaction, patients_admitted, and the rank. Include only the top 3 weeks per service.

***Querires

select patient_id, name, service, satisfaction, row_number() over (partition by service order by satisfaction desc)as rn 
from patients;

#2. 
select staff_name, row_number() over (order by staff_name )as rn from staff;

#3. 
select service, sum(patients_admitted) as total, rank() over (order by sum(patients_admitted) desc) as rn 
from services_weekly
group by service ;


#Daily Challenge:

with ranked_data as(
select 
  week, service, patient_satisfaction, 
  rank() over (partition by service order by patient_satisfaction desc)as satisfaction_rank
from services_weekly
)
select week, service, patient_satisfaction, satisfaction_rank 
from ranked_data
where satisfaction_rank <= 3
order by service, satisfaction_rank;


