Topics: INNER JOIN, joining two tables, relationship understanding

Practice Questions:

1. Join patients and staff based on their common service field (show patient and staff who work in same service).
2. Join services_weekly with staff to show weekly service data with staff information.
3. Create a report showing patient information along with staff assigned to their service.

### Daily Challenge:

Create a comprehensive report showing patient_id, patient name, age, service, and the total number of staff members available in their service. Only include patients from services that have more than 5 staff members. Order by number of staff descending, then by patient name.

***Queries:

#1.
select distinct s.service, p.patient_id, p.name, s.staff_id, s.staff_name 
from patients p
join staff s on p.service = s.service;

#2.
select sw.service, sw.week, s.staff_id, s.staff_name, 
sw.available_beds, sw.patients_request, sw.patients_admitted, sw.patients_refused 
from services_weekly sw
join staff s on sw.service = s.service;

#3.
select distinct s.service, p.patient_id, p.name, s.staff_id, s.staff_name 
from patients p
left join staff s on p.service = s.service; 

#Challenge:

WITH staff_count AS (
    SELECT service,COUNT(*) AS total_staff 
FROM staff GROUP BY service
)
SELECT p.patient_id, p.name AS patient_name, p.age,p.service,sc.total_staff
FROM patients p
JOIN staff_count sc ON p.service = sc.service
WHERE sc.total_staff > 5
ORDER BY sc.total_staff DESC, p.name ASC;


select p.patient_id, p.name, p.age, p.service, count(s.staff_id)as total_staff 
from patients p
left join staff s on p.service = s.service 
group by p.patient_id, p.name, p.age, p.service
having total_staff > 5
order by total_staff desc, p.name;




